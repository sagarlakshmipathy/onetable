<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-bigquery" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Google BigQuery | OneTable</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://onetable.dev/docs/bigquery"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Google BigQuery | OneTable"><meta data-rh="true" name="description" content="Iceberg tables"><meta data-rh="true" property="og:description" content="Iceberg tables"><link data-rh="true" rel="icon" href="/img/onetable_favicon.png"><link data-rh="true" rel="canonical" href="https://onetable.dev/docs/bigquery"><link data-rh="true" rel="alternate" href="https://onetable.dev/docs/bigquery" hreflang="en"><link data-rh="true" rel="alternate" href="https://onetable.dev/docs/bigquery" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.a7913edb.css">
<link rel="preload" href="/assets/js/runtime~main.f25bb5e1.js" as="script">
<link rel="preload" href="/assets/js/main.9e3d9427.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="/" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/Onetable_dark.png" alt="OneTable Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/Onetable_dark.png" alt="OneTable Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a class="navbar__item navbar__link" href="/docs/setup">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/onetable-io/onetable" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Google BigQuery</h1><h3 class="anchor anchorWithStickyNavbar_LWe7" id="iceberg-tables">Iceberg tables<a href="#iceberg-tables" class="hash-link" aria-label="Direct link to Iceberg tables" title="Direct link to Iceberg tables">​</a></h3><p>To read a OneTable synced <a href="https://cloud.google.com/bigquery/docs/iceberg-tables" target="_blank" rel="noopener noreferrer">Iceberg table from BigQuery</a>,
you have two options:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-iceberg-json-metadata-file-to-create-the-iceberg-biglake-tables"><a href="https://cloud.google.com/bigquery/docs/iceberg-tables#create-using-metadata-file" target="_blank" rel="noopener noreferrer">Using Iceberg JSON metadata file to create the Iceberg BigLake tables</a>:<a href="#using-iceberg-json-metadata-file-to-create-the-iceberg-biglake-tables" class="hash-link" aria-label="Direct link to using-iceberg-json-metadata-file-to-create-the-iceberg-biglake-tables" title="Direct link to using-iceberg-json-metadata-file-to-create-the-iceberg-biglake-tables">​</a></h4><p>OneTable outputs metadata files for Iceberg target format syncs which can be used by BigQuery
to read the BigLake tables.</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">sql</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> EXTERNAL </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> onetable_synced_iceberg_table</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WITH</span><span class="token plain"> CONNECTION </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">myproject.mylocation.myconnection</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OPTIONS </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     format </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ICEBERG&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     uris </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;gs://mybucket/mydata/mytable/metadata/iceberg.metadata.json&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Note:</div><div class="admonitionContent_S0QG"><p>This method requires you to keep the table updated when there are table updates and hence Google
<a href="/docs/(https://cloud.google.com/bigquery/docs/iceberg-tables#create-using-metadata-file)">does not recommend</a> this approach.</p></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Important: For Hudi source format to Iceberg target format use cases</div><div class="admonitionContent_S0QG"><p>The Hudi extensions provide the ability to add field IDs to the parquet schema when writing with Hudi.
This is a requirement for some engines, like BigQuery and Snowflake, when reading an Iceberg table.
If you are not planning on using Iceberg, then you do not need to add these to your Hudi writers.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="steps-to-add-additional-configurations-to-the-hudi-writers">Steps to add additional configurations to the Hudi writers:<a href="#steps-to-add-additional-configurations-to-the-hudi-writers" class="hash-link" aria-label="Direct link to Steps to add additional configurations to the Hudi writers:" title="Direct link to Steps to add additional configurations to the Hudi writers:">​</a></h4><ol><li>Add the extensions jar (<code>hudi-extensions-0.1.0-SNAPSHOT-bundled.jar</code>) to your class path<br>For example, if you&#x27;re using the Hudi <a href="https://hudi.apache.org/docs/quick-start-guide#spark-shellsql" target="_blank" rel="noopener noreferrer">quick-start guide</a>
for spark you can just add <code>--jars hudi-extensions-0.1.0-SNAPSHOT-bundled.jar</code> to the end of the command.</li><li>Set the following configurations in your writer options:<br><code>hoodie.avro.write.support.class: io.onetable.hudi.extensions.HoodieAvroWriteSupportWithFieldIds</code><code>hoodie.client.init.callback.classes: io.onetable.hudi.extensions.AddFieldIdsClientInitCallback</code></li><li>Run your existing code that use Hudi writers</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-biglake-metastore-to-create-the-iceberg-biglake-tables"><a href="https://cloud.google.com/bigquery/docs/iceberg-tables#create-using-biglake-metastore" target="_blank" rel="noopener noreferrer">Using BigLake Metastore to create the Iceberg BigLake tables</a>:<a href="#using-biglake-metastore-to-create-the-iceberg-biglake-tables" class="hash-link" aria-label="Direct link to using-biglake-metastore-to-create-the-iceberg-biglake-tables" title="Direct link to using-biglake-metastore-to-create-the-iceberg-biglake-tables">​</a></h4><p>You can use two options to register OneTable synced Iceberg tables to BigLake Metastore:</p><ul><li>To directly register the OneTable synced Iceberg table to BigLake Metastore,
follow the <a href="https://onetable.dev/docs/biglake-metastore" target="_blank" rel="noopener noreferrer">OneTable guide to integrate with BigLake Metastore</a></li><li>Use <a href="https://cloud.google.com/bigquery/docs/spark-procedures" target="_blank" rel="noopener noreferrer">stored procedures for Spark</a>
on BigQuery to register the table in BigLake Metastore and query the tables from BigQuery.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hudi-and-delta-tables">Hudi and Delta tables<a href="#hudi-and-delta-tables" class="hash-link" aria-label="Direct link to Hudi and Delta tables" title="Direct link to Hudi and Delta tables">​</a></h3><p><a href="https://cloud.google.com/bigquery/docs/query-open-table-format-using-manifest-files" target="_blank" rel="noopener noreferrer">This document</a>
explains how to query Hudi and Delta table formats through the use of manifest files.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#iceberg-tables" class="table-of-contents__link toc-highlight">Iceberg tables</a></li><li><a href="#hudi-and-delta-tables" class="table-of-contents__link toc-highlight">Hudi and Delta tables</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.f25bb5e1.js"></script>
<script src="/assets/js/main.9e3d9427.js"></script>
</body>
</html>